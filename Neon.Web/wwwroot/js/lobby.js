(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t);const n={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return o(this.context.count)},getNextContextId(){return o(this.context.count++)}};function o(e){const t=String(e),o=t.length-1;return n.context.id+(o?String.fromCharCode(96+o):"")+t}function r(e){n.context=e}const s=(e,t)=>e===t,i=Symbol("solid-proxy"),c=Symbol("solid-track"),a=(Symbol("solid-dev-component"),{equals:s});let l=null,u=N;const h=1,d=2,g={owned:null,cleanups:null,context:null,owner:null};var p=null;let f=null,_=null,m=null,v=null,w=null,y=null,b=0;function S(e,t){const n=v,o=p,r=0===e.length,s=void 0===t?o:t,i=r?g:{owned:null,cleanups:null,context:s?s.context:null,owner:s},c=r?e:()=>e((()=>T((()=>F(i)))));p=i,v=null;try{return j(c,!0)}finally{v=n,p=o}}function C(e,t){const n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},a,t):a).equals||void 0};return[q.bind(n),e=>("function"==typeof e&&(e=f&&f.running&&f.sources.has(n)?e(n.tValue):e(n.value)),M(n,e))]}function k(e,t,n){const o=B(e,t,!1,h);_&&f&&f.running?w.push(o):O(o)}function E(e,t,n){n=n?Object.assign({},a,n):a;const o=B(e,t,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=n.equals||void 0,_&&f&&f.running?(o.tState=h,w.push(o)):O(o),q.bind(o)}function I(e){return j(e,!1)}function T(e){if(!m&&null===v)return e();const t=v;v=null;try{return m?m.untrack(e):e()}finally{v=t}}function R(e){return null===p||(null===p.cleanups?p.cleanups=[e]:p.cleanups.push(e)),e}function P(){return v}function x(e){if(f&&f.running)return e(),f.done;const t=v,n=p;return Promise.resolve().then((()=>{let o;return v=t,p=n,(_||D)&&(o=f||(f={sources:new Set,effects:[],promises:new Set,disposed:new Set,queue:new Set,running:!0}),o.done||(o.done=new Promise((e=>o.resolve=e))),o.running=!0),j(e,!1),v=p=null,o?o.done:void 0}))}const[$,A]=C(!1);let D;function q(){const e=f&&f.running;if(this.sources&&(e?this.tState:this.state))if((e?this.tState:this.state)===h)O(this);else{const e=w;w=null,j((()=>H(this)),!1),w=e}if(v){const e=this.observers?this.observers.length:0;v.sources?(v.sources.push(this),v.sourceSlots.push(e)):(v.sources=[this],v.sourceSlots=[e]),this.observers?(this.observers.push(v),this.observerSlots.push(v.sources.length-1)):(this.observers=[v],this.observerSlots=[v.sources.length-1])}return e&&f.sources.has(this)?this.tValue:this.value}function M(e,t,n){let o=f&&f.running&&f.sources.has(e)?e.tValue:e.value;if(!e.comparator||!e.comparator(o,t)){if(f){const o=f.running;(o||!n&&f.sources.has(e))&&(f.sources.add(e),e.tValue=t),o||(e.value=t)}else e.value=t;e.observers&&e.observers.length&&j((()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t],o=f&&f.running;o&&f.disposed.has(n)||((o?n.tState:n.state)||(n.pure?w.push(n):y.push(n),n.observers&&W(n)),o?n.tState=h:n.state=h)}if(w.length>1e6)throw w=[],new Error}),!1)}return t}function O(e){if(!e.fn)return;F(e);const t=b;U(e,f&&f.running&&f.sources.has(e)?e.tValue:e.value,t),f&&!f.running&&f.sources.has(e)&&queueMicrotask((()=>{j((()=>{f&&(f.running=!0),v=p=e,U(e,e.tValue,t),v=p=null}),!1)}))}function U(e,t,n){let o;const r=p,s=v;v=p=e;try{o=e.fn(t)}catch(t){return e.pure&&(f&&f.running?(e.tState=h,e.tOwned&&e.tOwned.forEach(F),e.tOwned=void 0):(e.state=h,e.owned&&e.owned.forEach(F),e.owned=null)),e.updatedAt=n+1,X(t)}finally{v=s,p=r}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?M(e,o,!0):f&&f.running&&e.pure?(f.sources.add(e),e.tValue=o):e.value=o,e.updatedAt=n)}function B(e,t,n,o=h,r){const s={fn:e,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:p,context:p?p.context:null,pure:n};if(f&&f.running&&(s.state=0,s.tState=o),null===p||p!==g&&(f&&f.running&&p.pure?p.tOwned?p.tOwned.push(s):p.tOwned=[s]:p.owned?p.owned.push(s):p.owned=[s]),m&&s.fn){const[e,t]=C(void 0,{equals:!1}),n=m.factory(s.fn,t);R((()=>n.dispose()));const o=()=>x(t).then((()=>r.dispose())),r=m.factory(s.fn,o);s.fn=t=>(e(),f&&f.running?r.track(t):n.track(t))}return s}function L(e){const t=f&&f.running;if(0===(t?e.tState:e.state))return;if((t?e.tState:e.state)===d)return H(e);if(e.suspense&&T(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<b);){if(t&&f.disposed.has(e))return;(t?e.tState:e.state)&&n.push(e)}for(let o=n.length-1;o>=0;o--){if(e=n[o],t){let t=e,r=n[o+1];for(;(t=t.owner)&&t!==r;)if(f.disposed.has(t))return}if((t?e.tState:e.state)===h)O(e);else if((t?e.tState:e.state)===d){const t=w;w=null,j((()=>H(e,n[0])),!1),w=t}}}function j(e,t){if(w)return e();let n=!1;t||(w=[]),y?n=!0:y=[],b++;try{const t=e();return function(e){w&&(_&&f&&f.running?function(e){for(let t=0;t<e.length;t++){const n=e[t],o=f.queue;o.has(n)||(o.add(n),_((()=>{o.delete(n),j((()=>{f.running=!0,L(n)}),!1),f&&(f.running=!1)})))}}(w):N(w),w=null);if(e)return;let t;if(f)if(f.promises.size||f.queue.size){if(f.running)return f.running=!1,f.effects.push.apply(f.effects,y),y=null,void A(!0)}else{const e=f.sources,n=f.disposed;y.push.apply(y,f.effects),t=f.resolve;for(const e of y)"tState"in e&&(e.state=e.tState),delete e.tState;f=null,j((()=>{for(const e of n)F(e);for(const t of e){if(t.value=t.tValue,t.owned)for(let e=0,n=t.owned.length;e<n;e++)F(t.owned[e]);t.tOwned&&(t.owned=t.tOwned),delete t.tValue,delete t.tOwned,t.tState=0}A(!1)}),!1)}const n=y;y=null,n.length&&j((()=>u(n)),!1);t&&t()}(n),t}catch(e){n||(y=null),w=null,X(e)}}function N(e){for(let t=0;t<e.length;t++)L(e[t])}function H(e,t){const n=f&&f.running;n?e.tState=0:e.state=0;for(let o=0;o<e.sources.length;o+=1){const r=e.sources[o];if(r.sources){const e=n?r.tState:r.state;e===h?r!==t&&(!r.updatedAt||r.updatedAt<b)&&L(r):e===d&&H(r,t)}}}function W(e){const t=f&&f.running;for(let n=0;n<e.observers.length;n+=1){const o=e.observers[n];(t?o.tState:o.state)||(t?o.tState=d:o.state=d,o.pure?w.push(o):y.push(o),o.observers&&W(o))}}function F(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),o=t.observers;if(o&&o.length){const e=o.pop(),r=t.observerSlots.pop();n<o.length&&(e.sourceSlots[r]=n,o[n]=e,t.observerSlots[n]=r)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)F(e.tOwned[t]);delete e.tOwned}if(f&&f.running&&e.pure)z(e,!0);else if(e.owned){for(t=e.owned.length-1;t>=0;t--)F(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}f&&f.running?e.tState=0:e.state=0}function z(e,t){if(t||(e.tState=0,f.disposed.add(e)),e.owned)for(let t=0;t<e.owned.length;t++)z(e.owned[t])}function V(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function K(e,t,n){try{for(const n of t)n(e)}catch(e){X(e,n&&n.owner||null)}}function X(e,t=p){const n=l&&t&&t.context&&t.context[l],o=V(e);if(!n)throw o;y?y.push({fn(){K(o,n,t)},state:h}):K(o,n,t)}const J=Symbol("fallback");function Q(e){for(let t=0;t<e.length;t++)e[t]()}let G=!1;function Z(e,t){if(G&&n.context){const o=n.context;r({...n.context,id:n.getNextContextId(),count:0});const s=T((()=>e(t||{})));return r(o),s}return T((()=>e(t||{})))}function Y(e){const t="fallback"in e&&{fallback:()=>e.fallback};return E(function(e,t,n={}){let o=[],r=[],s=[],i=0,a=t.length>1?[]:null;return R((()=>Q(s))),()=>{let l,u,h=e()||[],d=h.length;return h[c],T((()=>{let e,t,c,p,f,_,m,v,w;if(0===d)0!==i&&(Q(s),s=[],o=[],r=[],i=0,a&&(a=[])),n.fallback&&(o=[J],r[0]=S((e=>(s[0]=e,n.fallback()))),i=1);else if(0===i){for(r=new Array(d),u=0;u<d;u++)o[u]=h[u],r[u]=S(g);i=d}else{for(c=new Array(d),p=new Array(d),a&&(f=new Array(d)),_=0,m=Math.min(i,d);_<m&&o[_]===h[_];_++);for(m=i-1,v=d-1;m>=_&&v>=_&&o[m]===h[v];m--,v--)c[v]=r[m],p[v]=s[m],a&&(f[v]=a[m]);for(e=new Map,t=new Array(v+1),u=v;u>=_;u--)w=h[u],l=e.get(w),t[u]=void 0===l?-1:l,e.set(w,u);for(l=_;l<=m;l++)w=o[l],u=e.get(w),void 0!==u&&-1!==u?(c[u]=r[l],p[u]=s[l],a&&(f[u]=a[l]),u=t[u],e.set(w,u)):s[l]();for(u=_;u<d;u++)u in c?(r[u]=c[u],s[u]=p[u],a&&(a[u]=f[u],a[u](u))):r[u]=S(g);r=r.slice(0,i=d),o=h.slice(0)}return r}));function g(e){if(s[u]=e,a){const[e,n]=C(u);return a[u]=n,t(h[u],e)}return t(h[u])}}}((()=>e.each),e.children,t||void 0))}const ee=[0,2e3,1e4,3e4,null];class te{constructor(e){this._retryDelays=void 0!==e?[...e,null]:ee}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class ne{}ne.Authorization="Authorization",ne.Cookie="Cookie";class oe{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}class re{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}class se extends re{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const n=await this._innerClient.send(e);return t&&401===n.statusCode&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):n}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[ne.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[ne.Authorization]&&delete e.headers[ne.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}class ie extends Error{constructor(e,t){const n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n}}class ce extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class ae extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class le extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=n}}class ue extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=n}}class he extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=n}}class de extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class ge extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n}}var pe;!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(pe||(pe={}));class fe{constructor(){}log(e,t){}}fe.instance=new fe;class _e{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}}class me{static get isBrowser(){return!me.isNode&&"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return!me.isNode&&"object"==typeof self&&"importScripts"in self}static get isReactNative(){return!me.isNode&&"object"==typeof window&&void 0===window.document}static get isNode(){return"undefined"!=typeof process&&process.release&&"node"===process.release.name}}function ve(e,t){let n="";return we(e)?(n=`Binary data of length ${e.byteLength}`,t&&(n+=`. Content: '${function(e){const t=new Uint8Array(e);let n="";return t.forEach((e=>{n+=`0x${e<16?"0":""}${e.toString(16)} `})),n.substr(0,n.length-1)}(e)}'`)):"string"==typeof e&&(n=`String data of length ${e.length}`,t&&(n+=`. Content: '${e}'`)),n}function we(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}async function ye(e,t,n,o,r,s){const i={},[c,a]=Ce();i[c]=a,e.log(pe.Trace,`(${t} transport) sending data. ${ve(r,s.logMessageContent)}.`);const l=we(r)?"arraybuffer":"text",u=await n.post(o,{content:r,headers:{...i,...s.headers},responseType:l,timeout:s.timeout,withCredentials:s.withCredentials});e.log(pe.Trace,`(${t} transport) request complete. Response status: ${u.statusCode}.`)}class be{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((e=>{}))}}class Se{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const n=`[${(new Date).toISOString()}] ${pe[e]}: ${t}`;switch(e){case pe.Critical:case pe.Error:this.out.error(n);break;case pe.Warning:this.out.warn(n);break;case pe.Information:this.out.info(n);break;default:this.out.log(n)}}}}function Ce(){let e="X-SignalR-User-Agent";return me.isNode&&(e="User-Agent"),[e,ke("8.0.7",Ee(),Te(),Ie())]}function ke(e,t,n,o){let r="Microsoft SignalR/";const s=e.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${e}; `,r+=t&&""!==t?`${t}; `:"Unknown OS; ",r+=`${n}`,r+=o?`; ${o}`:"; Unknown Runtime Version",r+=")",r}function Ee(){if(!me.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function Ie(){if(me.isNode)return process.versions.node}function Te(){return me.isNode?"NodeJS":"Browser"}function Re(e){return e.stack?e.stack:e.message?e.message:`${e}`}class Pe extends re{constructor(t){if(super(),this._logger=t,"undefined"==typeof fetch||me.isNode){const e=require;this._jar=new(e("tough-cookie").CookieJar),"undefined"==typeof fetch?this._fetchType=e("node-fetch"):this._fetchType=fetch,this._fetchType=e("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const e=require;this._abortControllerType=e("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new ae;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let n;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),n=new ae});let o,r=null;if(e.timeout){const o=e.timeout;r=setTimeout((()=>{t.abort(),this._logger.log(pe.Warning,"Timeout from HTTP request."),n=new ce}),o)}""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},we(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");try{o=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(e){if(n)throw n;throw this._logger.log(pe.Warning,`Error from HTTP request. ${e}.`),e}finally{r&&clearTimeout(r),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const e=await xe(o,"text");throw new ie(e||o.statusText,o.status)}const s=xe(o,e.responseType),i=await s;return new oe(o.status,o.statusText,i)}getCookieString(e){let t="";return me.isNode&&this._jar&&this._jar.getCookies(e,((e,n)=>t=n.join("; "))),t}}function xe(e,t){let n;switch(t){case"arraybuffer":n=e.arrayBuffer();break;case"text":default:n=e.text();break;case"blob":case"document":case"json":throw new Error(`${t} is not supported.`)}return n}class $e extends re{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ae):e.method?e.url?new Promise(((t,n)=>{const o=new XMLHttpRequest;o.open(e.method,e.url,!0),o.withCredentials=void 0===e.withCredentials||e.withCredentials,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(we(e.content)?o.setRequestHeader("Content-Type","application/octet-stream"):o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const r=e.headers;r&&Object.keys(r).forEach((e=>{o.setRequestHeader(e,r[e])})),e.responseType&&(o.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{o.abort(),n(new ae)}),e.timeout&&(o.timeout=e.timeout),o.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),o.status>=200&&o.status<300?t(new oe(o.status,o.statusText,o.response||o.responseText)):n(new ie(o.response||o.responseText||o.statusText,o.status))},o.onerror=()=>{this._logger.log(pe.Warning,`Error from HTTP request. ${o.status}: ${o.statusText}.`),n(new ie(o.statusText,o.status))},o.ontimeout=()=>{this._logger.log(pe.Warning,"Timeout from HTTP request."),n(new ce)},o.send(e.content)})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Ae extends re{constructor(e){if(super(),"undefined"!=typeof fetch||me.isNode)this._httpClient=new Pe(e);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new $e(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ae):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}var De,qe;!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(De||(De={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(qe||(qe={}));class Me{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class Oe{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,n){this._httpClient=e,this._logger=t,this._pollAbort=new Me,this._options=n,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(_e.isRequired(e,"url"),_e.isRequired(t,"transferFormat"),_e.isIn(t,qe,"transferFormat"),this._url=e,this._logger.log(pe.Trace,"(LongPolling transport) Connecting."),t===qe.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[n,o]=Ce(),r={[n]:o,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:r,timeout:1e5,withCredentials:this._options.withCredentials};t===qe.Binary&&(s.responseType="arraybuffer");const i=`${e}&_=${Date.now()}`;this._logger.log(pe.Trace,`(LongPolling transport) polling: ${i}.`);const c=await this._httpClient.get(i,s);200!==c.statusCode?(this._logger.log(pe.Error,`(LongPolling transport) Unexpected response code: ${c.statusCode}.`),this._closeError=new ie(c.statusText||"",c.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(e,t){try{for(;this._running;)try{const n=`${e}&_=${Date.now()}`;this._logger.log(pe.Trace,`(LongPolling transport) polling: ${n}.`);const o=await this._httpClient.get(n,t);204===o.statusCode?(this._logger.log(pe.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==o.statusCode?(this._logger.log(pe.Error,`(LongPolling transport) Unexpected response code: ${o.statusCode}.`),this._closeError=new ie(o.statusText||"",o.statusCode),this._running=!1):o.content?(this._logger.log(pe.Trace,`(LongPolling transport) data received. ${ve(o.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(o.content)):this._logger.log(pe.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(e){this._running?e instanceof ce?this._logger.log(pe.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=e,this._running=!1):this._logger.log(pe.Trace,`(LongPolling transport) Poll errored after shutdown: ${e.message}`)}}finally{this._logger.log(pe.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?ye(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(pe.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(pe.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,n]=Ce();e[t]=n;const o={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let r;try{await this._httpClient.delete(this._url,o)}catch(e){r=e}r?r instanceof ie&&(404===r.statusCode?this._logger.log(pe.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(pe.Trace,`(LongPolling transport) Error sending a DELETE request: ${r}`)):this._logger.log(pe.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(pe.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(pe.Trace,e),this.onclose(this._closeError)}}}class Ue{constructor(e,t,n,o){this._httpClient=e,this._accessToken=t,this._logger=n,this._options=o,this.onreceive=null,this.onclose=null}async connect(e,t){return _e.isRequired(e,"url"),_e.isRequired(t,"transferFormat"),_e.isIn(t,qe,"transferFormat"),this._logger.log(pe.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise(((n,o)=>{let r,s=!1;if(t===qe.Text){if(me.isBrowser||me.isWebWorker)r=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const t=this._httpClient.getCookieString(e),n={};n.Cookie=t;const[o,s]=Ce();n[o]=s,r=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...n,...this._options.headers}})}try{r.onmessage=e=>{if(this.onreceive)try{this._logger.log(pe.Trace,`(SSE transport) data received. ${ve(e.data,this._options.logMessageContent)}.`),this.onreceive(e.data)}catch(e){return void this._close(e)}},r.onerror=e=>{s?this._close():o(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},r.onopen=()=>{this._logger.log(pe.Information,`SSE connected to ${this._url}`),this._eventSource=r,s=!0,n()}}catch(e){return void o(e)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(e){return this._eventSource?ye(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Be{constructor(e,t,n,o,r,s){this._logger=n,this._accessTokenFactory=t,this._logMessageContent=o,this._webSocketConstructor=r,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){let n;return _e.isRequired(e,"url"),_e.isRequired(t,"transferFormat"),_e.isIn(t,qe,"transferFormat"),this._logger.log(pe.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(n=await this._accessTokenFactory()),new Promise(((o,r)=>{let s;e=e.replace(/^http/,"ws");const i=this._httpClient.getCookieString(e);let c=!1;if(me.isNode||me.isReactNative){const t={},[o,r]=Ce();t[o]=r,n&&(t[ne.Authorization]=`Bearer ${n}`),i&&(t[ne.Cookie]=i),s=new this._webSocketConstructor(e,void 0,{headers:{...t,...this._headers}})}else n&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(n)}`);s||(s=new this._webSocketConstructor(e)),t===qe.Binary&&(s.binaryType="arraybuffer"),s.onopen=t=>{this._logger.log(pe.Information,`WebSocket connected to ${e}.`),this._webSocket=s,c=!0,o()},s.onerror=e=>{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"There was an error with the transport",this._logger.log(pe.Information,`(WebSockets transport) ${t}.`)},s.onmessage=e=>{if(this._logger.log(pe.Trace,`(WebSockets transport) data received. ${ve(e.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(e.data)}catch(e){return void this._close(e)}},s.onclose=e=>{if(c)this._close(e);else{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",r(new Error(t))}}}))}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(pe.Trace,`(WebSockets transport) sending data. ${ve(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(pe.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class Le{constructor(e,t={}){var n;if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,_e.isRequired(e,"url"),this._logger=void 0===(n=t.logger)?new Se(pe.Information):null===n?fe.instance:void 0!==n.log?n:new Se(n),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let o=null,r=null;if(me.isNode){const e=require;o=e("ws"),r=e("eventsource")}me.isNode||"undefined"==typeof WebSocket||t.WebSocket?me.isNode&&!t.WebSocket&&o&&(t.WebSocket=o):t.WebSocket=WebSocket,me.isNode||"undefined"==typeof EventSource||t.EventSource?me.isNode&&!t.EventSource&&void 0!==r&&(t.EventSource=r):t.EventSource=EventSource,this._httpClient=new se(t.httpClient||new Ae(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||qe.Binary,_e.isIn(e,qe,"transferFormat"),this._logger.log(pe.Debug,`Starting connection with transfer format '${qe[e]}'.`),"Disconnected"!==this._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,"Disconnecting"===this._connectionState){const e="Failed to start the HttpConnection before stop() was called.";return this._logger.log(pe.Error,e),await this._stopPromise,Promise.reject(new ae(e))}if("Connected"!==this._connectionState){const e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(pe.Error,e),Promise.reject(new ae(e))}this._connectionStarted=!0}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new je(this.transport)),this._sendQueue.send(e))}async stop(e){return"Disconnected"===this._connectionState?(this._logger.log(pe.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this._connectionState?(this._logger.log(pe.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise((e=>{this._stopPromiseResolver=e})),await this._stopInternal(e),void await this._stopPromise)}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch(e){}if(this.transport){try{await this.transport.stop()}catch(e){this._logger.log(pe.Error,`HttpConnection.transport.stop() threw error '${e}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(pe.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==De.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(De.WebSockets),await this._startTransport(t,e)}else{let n=null,o=0;do{if(n=await this._getNegotiationResponse(t),"Disconnecting"===this._connectionState||"Disconnected"===this._connectionState)throw new ae("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(t=n.url),n.accessToken){const e=n.accessToken;this._accessTokenFactory=()=>e,this._httpClient._accessToken=e,this._httpClient._accessTokenFactory=void 0}o++}while(n.url&&o<100);if(100===o&&n.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,n,e)}this.transport instanceof Oe&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(pe.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(e){return this._logger.log(pe.Error,"Failed to start the connection: "+e),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(e)}}async _getNegotiationResponse(e){const t={},[n,o]=Ce();t[n]=o;const r=this._resolveNegotiateUrl(e);this._logger.log(pe.Debug,`Sending negotiation request: ${r}.`);try{const e=await this._httpClient.post(r,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(200!==e.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${e.statusCode}'`));const n=JSON.parse(e.content);return(!n.negotiateVersion||n.negotiateVersion<1)&&(n.connectionToken=n.connectionId),n.useStatefulReconnect&&!0!==this._options._useStatefulReconnect?Promise.reject(new de("Client didn't negotiate Stateful Reconnect but the server did.")):n}catch(e){let t="Failed to complete negotiation with the server: "+e;return e instanceof ie&&404===e.statusCode&&(t+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(pe.Error,t),Promise.reject(new de(t))}}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}async _createTransport(e,t,n,o){let r=this._createConnectUrl(e,n.connectionToken);if(this._isITransport(t))return this._logger.log(pe.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(r,o),void(this.connectionId=n.connectionId);const s=[],i=n.availableTransports||[];let c=n;for(const n of i){const i=this._resolveTransportOrError(n,t,o,!0===(null==c?void 0:c.useStatefulReconnect));if(i instanceof Error)s.push(`${n.transport} failed:`),s.push(i);else if(this._isITransport(i)){if(this.transport=i,!c){try{c=await this._getNegotiationResponse(e)}catch(e){return Promise.reject(e)}r=this._createConnectUrl(e,c.connectionToken)}try{return await this._startTransport(r,o),void(this.connectionId=c.connectionId)}catch(e){if(this._logger.log(pe.Error,`Failed to start the transport '${n.transport}': ${e}`),c=void 0,s.push(new he(`${n.transport} failed: ${e}`,De[n.transport])),"Connecting"!==this._connectionState){const e="Failed to select transport before stop() was called.";return this._logger.log(pe.Debug,e),Promise.reject(new ae(e))}}}}return s.length>0?Promise.reject(new ge(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case De.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Be(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case De.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Ue(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case De.LongPolling:return new Oe(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async n=>{let o=!1;if(this.features.reconnect){try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{o=!0}o&&this._stopConnection(n)}else this._stopConnection(n)}:this.transport.onclose=e=>this._stopConnection(e),this.transport.connect(e,t)}_resolveTransportOrError(e,t,n,o){const r=De[e.transport];if(null==r)return this._logger.log(pe.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(e,t){return!e||!!(t&e)}(t,r))return this._logger.log(pe.Debug,`Skipping transport '${De[r]}' because it was disabled by the client.`),new ue(`'${De[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map((e=>qe[e])).indexOf(n)>=0))return this._logger.log(pe.Debug,`Skipping transport '${De[r]}' because it does not support the requested transfer format '${qe[n]}'.`),new Error(`'${De[r]}' does not support ${qe[n]}.`);if(r===De.WebSockets&&!this._options.WebSocket||r===De.ServerSentEvents&&!this._options.EventSource)return this._logger.log(pe.Debug,`Skipping transport '${De[r]}' because it is not supported in your environment.'`),new le(`'${De[r]}' is not supported in your environment.`,r);this._logger.log(pe.Debug,`Selecting transport '${De[r]}'.`);try{return this.features.reconnect=r===De.WebSockets?o:void 0,this._constructTransport(r)}catch(e){return e}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(pe.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(pe.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(pe.Error,`Connection disconnected with error '${e}'.`):this._logger.log(pe.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((e=>{this._logger.log(pe.Error,`TransportSendQueue.stop() threw error '${e}'.`)})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(pe.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(pe.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!me.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(pe.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const n=new URLSearchParams(t.searchParams);return n.has("negotiateVersion")||n.append("negotiateVersion",this._negotiateVersion.toString()),n.has("useStatefulReconnect")?"true"===n.get("useStatefulReconnect")&&(this._options._useStatefulReconnect=!0):!0===this._options._useStatefulReconnect&&n.append("useStatefulReconnect","true"),t.search=n.toString(),t.toString()}}class je{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Ne,this._transportResult=new Ne,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Ne),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Ne;const e=this._transportResult;this._transportResult=void 0;const t="string"==typeof this._buffer[0]?this._buffer.join(""):je._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(t){e.reject(t)}}}static _concatBuffers(e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),n=new Uint8Array(t);let o=0;for(const t of e)n.set(new Uint8Array(t),o),o+=t.byteLength;return n.buffer}}class Ne{constructor(){this.promise=new Promise(((e,t)=>[this._resolver,this._rejecter]=[e,t]))}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class He{static write(e){return`${e}${He.RecordSeparator}`}static parse(e){if(e[e.length-1]!==He.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(He.RecordSeparator);return t.pop(),t}}He.RecordSeparatorCode=30,He.RecordSeparator=String.fromCharCode(He.RecordSeparatorCode);class We{writeHandshakeRequest(e){return He.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(we(e)){const o=new Uint8Array(e),r=o.indexOf(He.RecordSeparatorCode);if(-1===r)throw new Error("Message is incomplete.");const s=r+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(o.slice(0,s))),n=o.byteLength>s?o.slice(s).buffer:null}else{const o=e,r=o.indexOf(He.RecordSeparator);if(-1===r)throw new Error("Message is incomplete.");const s=r+1;t=o.substring(0,s),n=o.length>s?o.substring(s):null}const o=He.parse(t),r=JSON.parse(o[0]);if(r.type)throw new Error("Expected a handshake response from the server.");return[n,r]}}var Fe;!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close",e[e.Ack=8]="Ack",e[e.Sequence=9]="Sequence"}(Fe||(Fe={}));class ze{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new be(this,e)}}class Ve{constructor(e,t,n){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=n}async _send(e){const t=this._protocol.writeMessage(e);let n=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let e=()=>{},o=()=>{};we(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(n=new Promise(((t,n)=>{e=t,o=n}))),this._messages.push(new Ke(t,this._totalMessageCount,e,o))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await n}_ack(e){let t=-1;for(let n=0;n<this._messages.length;n++){const o=this._messages[n];if(o._id<=e.sequenceId)t=n,we(o._message)?this._bufferedByteCount-=o._message.byteLength:this._bufferedByteCount-=o._message.length,o._resolver();else{if(!(this._bufferedByteCount<this._bufferSize))break;o._resolver()}}-1!==t&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type===Fe.Sequence&&(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){e.sequenceId>this._nextReceivingSequenceId?this._connection.stop(new Error("Sequence ID greater than amount of messages we've received.")):this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=0!==this._messages.length?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:Fe.Sequence,sequenceId:e}));const t=this._messages;for(const e of t)await this._connection.send(e._message);this._reconnectInProgress=!1}_dispose(e){null!=e||(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case Fe.Invocation:case Fe.StreamItem:case Fe.Completion:case Fe.StreamInvocation:case Fe.CancelInvocation:return!0;case Fe.Close:case Fe.Sequence:case Fe.Ping:case Fe.Ack:return!1}}_ackTimer(){void 0===this._ackTimerHandle&&(this._ackTimerHandle=setTimeout((async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:Fe.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0}),1e3))}}class Ke{constructor(e,t,n,o){this._message=e,this._id=t,this._resolver=n,this._rejector=o}}var Xe;!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting"}(Xe||(Xe={}));class Je{static create(e,t,n,o,r,s,i){return new Je(e,t,n,o,r,s,i)}constructor(e,t,n,o,r,s,i){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(pe.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},_e.isRequired(e,"connection"),_e.isRequired(t,"logger"),_e.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=null!=r?r:3e4,this.keepAliveIntervalInMilliseconds=null!=s?s:15e3,this._statefulReconnectBufferSize=null!=i?i:1e5,this._logger=t,this._protocol=n,this.connection=e,this._reconnectPolicy=o,this._handshakeProtocol=new We,this.connection.onreceive=e=>this._processIncomingData(e),this.connection.onclose=e=>this._connectionClosed(e),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Xe.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:Fe.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Xe.Disconnected&&this._connectionState!==Xe.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==Xe.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=Xe.Connecting,this._logger.log(pe.Debug,"Starting HubConnection.");try{await this._startInternal(),me.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=Xe.Connected,this._connectionStarted=!0,this._logger.log(pe.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=Xe.Disconnected,this._logger.log(pe.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise(((e,t)=>{this._handshakeResolver=e,this._handshakeRejecter=t}));await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const n={protocol:this._protocol.name,version:t};if(this._logger.log(pe.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(n)),this._logger.log(pe.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new Ve(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(e){throw this._logger.log(pe.Debug,`Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(e),e}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch(e){}}_stopInternal(e){if(this._connectionState===Xe.Disconnected)return this._logger.log(pe.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===Xe.Disconnecting)return this._logger.log(pe.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=Xe.Disconnecting,this._logger.log(pe.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(pe.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===Xe.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new ae("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[n,o]=this._replaceStreamingParams(t),r=this._createStreamInvocation(e,t,o);let s;const i=new ze;return i.cancelCallback=()=>{const e=this._createCancelInvocation(r.invocationId);return delete this._callbacks[r.invocationId],s.then((()=>this._sendWithProtocol(e)))},this._callbacks[r.invocationId]=(e,t)=>{t?i.error(t):e&&(e.type===Fe.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item))},s=this._sendWithProtocol(r).catch((e=>{i.error(e),delete this._callbacks[r.invocationId]})),this._launchStreams(n,s),i}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[n,o]=this._replaceStreamingParams(t),r=this._sendWithProtocol(this._createInvocation(e,t,!0,o));return this._launchStreams(n,r),r}invoke(e,...t){const[n,o]=this._replaceStreamingParams(t),r=this._createInvocation(e,t,!1,o);return new Promise(((e,t)=>{this._callbacks[r.invocationId]=(n,o)=>{o?t(o):n&&(n.type===Fe.Completion?n.error?t(new Error(n.error)):e(n.result):t(new Error(`Unexpected message type: ${n.type}`)))};const o=this._sendWithProtocol(r).catch((e=>{t(e),delete this._callbacks[r.invocationId]}));this._launchStreams(n,o)}))}on(e,t){e&&t&&(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const n=this._methods[e];if(n)if(t){const o=n.indexOf(t);-1!==o&&(n.splice(o,1),0===n.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const e of t)if(!this._messageBuffer||this._messageBuffer._shouldProcessMessage(e))switch(e.type){case Fe.Invocation:this._invokeClientMethod(e).catch((e=>{this._logger.log(pe.Error,`Invoke client method threw error: ${Re(e)}`)}));break;case Fe.StreamItem:case Fe.Completion:{const t=this._callbacks[e.invocationId];if(t){e.type===Fe.Completion&&delete this._callbacks[e.invocationId];try{t(e)}catch(e){this._logger.log(pe.Error,`Stream callback threw error: ${Re(e)}`)}}break}case Fe.Ping:break;case Fe.Close:{this._logger.log(pe.Information,"Close message received from server.");const t=e.error?new Error("Server returned an error on close: "+e.error):void 0;!0===e.allowReconnect?this.connection.stop(t):this._stopPromise=this._stopInternal(t);break}case Fe.Ack:this._messageBuffer&&this._messageBuffer._ack(e);break;case Fe.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(e);break;default:this._logger.log(pe.Warning,`Invalid message type: ${e.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,n;try{[n,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(e){const t="Error parsing handshake response: "+e;this._logger.log(pe.Error,t);const n=new Error(t);throw this._handshakeRejecter(n),n}if(t.error){const e="Server returned handshake error: "+t.error;this._logger.log(pe.Error,e);const n=new Error(e);throw this._handshakeRejecter(n),n}return this._logger.log(pe.Debug,"Server handshake complete."),this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let e=this._nextKeepAlive-(new Date).getTime();e<0&&(e=0),this._pingServerHandle=setTimeout((async()=>{if(this._connectionState===Xe.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),n=this._methods[t];if(!n)return this._logger.log(pe.Warning,`No client method with the name '${t}' found.`),void(e.invocationId&&(this._logger.log(pe.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const o=n.slice(),r=!!e.invocationId;let s,i,c;for(const n of o)try{const o=s;s=await n.apply(this,e.arguments),r&&s&&o&&(this._logger.log(pe.Error,`Multiple results provided for '${t}'. Sending error to server.`),c=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),i=void 0}catch(e){i=e,this._logger.log(pe.Error,`A callback for the method '${t}' threw error '${e}'.`)}c?await this._sendWithProtocol(c):r?(i?c=this._createCompletionMessage(e.invocationId,`${i}`,null):void 0!==s?c=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(pe.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),c=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(c)):s&&this._logger.log(pe.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(pe.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new ae("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Xe.Disconnecting?this._completeClose(e):this._connectionState===Xe.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Xe.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=Xe.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(null!=e?e:new Error("Connection closed.")),this._messageBuffer=void 0),me.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(pe.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let n=0,o=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),r=this._getNextRetryDelay(n++,0,o);if(null===r)return this._logger.log(pe.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(e);if(this._connectionState=Xe.Reconnecting,e?this._logger.log(pe.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(pe.Information,"Connection reconnecting."),0!==this._reconnectingCallbacks.length){try{this._reconnectingCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(pe.Error,`An onreconnecting callback called with error '${e}' threw error '${t}'.`)}if(this._connectionState!==Xe.Reconnecting)return void this._logger.log(pe.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==r;){if(this._logger.log(pe.Information,`Reconnect attempt number ${n} will start in ${r} ms.`),await new Promise((e=>{this._reconnectDelayHandle=setTimeout(e,r)})),this._reconnectDelayHandle=void 0,this._connectionState!==Xe.Reconnecting)return void this._logger.log(pe.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=Xe.Connected,this._logger.log(pe.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((e=>e.apply(this,[this.connection.connectionId])))}catch(e){this._logger.log(pe.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`)}return}catch(e){if(this._logger.log(pe.Information,`Reconnect attempt failed because of error '${e}'.`),this._connectionState!==Xe.Reconnecting)return this._logger.log(pe.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===Xe.Disconnecting&&this._completeClose());o=e instanceof Error?e:new Error(e.toString()),r=this._getNextRetryDelay(n++,Date.now()-t,o)}}this._logger.log(pe.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(n){return this._logger.log(pe.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${n}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach((n=>{const o=t[n];try{o(null,e)}catch(t){this._logger.log(pe.Error,`Stream 'error' callback called with '${e}' threw error: ${Re(t)}`)}}))}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,n,o){if(n)return 0!==o.length?{arguments:t,streamIds:o,target:e,type:Fe.Invocation}:{arguments:t,target:e,type:Fe.Invocation};{const n=this._invocationId;return this._invocationId++,0!==o.length?{arguments:t,invocationId:n.toString(),streamIds:o,target:e,type:Fe.Invocation}:{arguments:t,invocationId:n.toString(),target:e,type:Fe.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const n in e)e[n].subscribe({complete:()=>{t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n))))},error:e=>{let o;o=e instanceof Error?e.message:e&&e.toString?e.toString():"Unknown error",t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n,o))))},next:e=>{t=t.then((()=>this._sendWithProtocol(this._createStreamItemMessage(n,e))))}})}}_replaceStreamingParams(e){const t=[],n=[];for(let o=0;o<e.length;o++){const r=e[o];if(this._isObservable(r)){const s=this._invocationId;this._invocationId++,t[s]=r,n.push(s.toString()),e.splice(o,1)}}return[t,n]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,n){const o=this._invocationId;return this._invocationId++,0!==n.length?{arguments:t,invocationId:o.toString(),streamIds:n,target:e,type:Fe.StreamInvocation}:{arguments:t,invocationId:o.toString(),target:e,type:Fe.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:Fe.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:Fe.StreamItem}}_createCompletionMessage(e,t,n){return t?{error:t,invocationId:e,type:Fe.Completion}:{invocationId:e,result:n,type:Fe.Completion}}_createCloseMessage(){return{type:Fe.Close}}}class Qe{constructor(){this.name="json",this.version=2,this.transferFormat=qe.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=fe.instance);const n=He.parse(e),o=[];for(const e of n){const n=JSON.parse(e);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case Fe.Invocation:this._isInvocationMessage(n);break;case Fe.StreamItem:this._isStreamItemMessage(n);break;case Fe.Completion:this._isCompletionMessage(n);break;case Fe.Ping:case Fe.Close:break;case Fe.Ack:this._isAckMessage(n);break;case Fe.Sequence:this._isSequenceMessage(n);break;default:t.log(pe.Information,"Unknown message type '"+n.type+"' ignored.");continue}o.push(n)}return o}writeMessage(e){return He.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Ge={trace:pe.Trace,debug:pe.Debug,info:pe.Information,information:pe.Information,warn:pe.Warning,warning:pe.Warning,error:pe.Error,critical:pe.Critical,none:pe.None};const Ze=function(e){return e.replace(/[&<>"']/g,(e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return"&#039;"}}))};var Ye=function(e){return e[e.Guest=1]="Guest",e[e.Standard=2]="Standard",e[e.Admin=3]="Admin",e}(Ye||{});const et=Ye;var tt=function(e){return e.Duel="Duel",e.Trade="Trade",e.Friend="Friend",e}(tt||{});let nt=function(e){return e[e.Duel=1]="Duel",e[e.Trade=2]="Trade",e[e.Friend=3]="Friend",e}({});const ot=e=>tt[nt[e]],rt=tt;Object.create(null),Object.create(null);const st="_$DX_DELEGATE";function it(e,t,n,o={}){let r;return S((o=>{r=o,t===document?e():ut(t,e(),t.firstChild?null:void 0,n)}),o.owner),()=>{r(),t.textContent=""}}function ct(e,t,n){let o;const r=()=>{const t=document.createElement("template");return t.innerHTML=e,n?t.content.firstChild.firstChild:t.content.firstChild},s=t?()=>T((()=>document.importNode(o||(o=r()),!0))):()=>(o||(o=r())).cloneNode(!0);return s.cloneNode=s,s}function at(e,t=window.document){const n=t[st]||(t[st]=new Set);for(let o=0,r=e.length;o<r;o++){const r=e[o];n.has(r)||(n.add(r),t.addEventListener(r,dt))}}function lt(e,t){ht(e)||(null==t?e.removeAttribute("class"):e.className=t)}function ut(e,t,n,o){if(void 0===n||o||(o=[]),"function"!=typeof t)return gt(e,t,o,n);k((o=>gt(e,t(),o,n)),o)}function ht(e){return!!n.context&&!n.done&&(!e||e.isConnected)}function dt(e){if(n.registry&&n.events&&n.events.find((([t,n])=>n===e)))return;let t=e.target;const o=`$$${e.type}`,r=e.target,s=e.currentTarget,i=t=>Object.defineProperty(e,"target",{configurable:!0,value:t}),c=()=>{const n=t[o];if(n&&!t.disabled){const r=t[`${o}Data`];if(void 0!==r?n.call(t,r,e):n.call(t,e),e.cancelBubble)return}return t.host&&"string"!=typeof t.host&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},a=()=>{for(;c()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>t||document}),n.registry&&!n.done&&(n.done=_$HY.done=!0),e.composedPath){const n=e.composedPath();i(n[0]);for(let e=0;e<n.length-2&&(t=n[e],c());e++){if(t._$host){t=t._$host,a();break}if(t.parentNode===s)break}}else a();i(r)}function gt(e,t,n,o,r){const s=ht(e);if(s){!n&&(n=[...e.childNodes]);let t=[];for(let e=0;e<n.length;e++){const o=n[e];8===o.nodeType&&"!$"===o.data.slice(0,2)?o.remove():t.push(o)}n=t}for(;"function"==typeof n;)n=n();if(t===n)return n;const i=typeof t,c=void 0!==o;if(e=c&&n[0]&&n[0].parentNode||e,"string"===i||"number"===i){if(s)return n;if("number"===i&&(t=t.toString())===n)return n;if(c){let r=n[0];r&&3===r.nodeType?r.data!==t&&(r.data=t):r=document.createTextNode(t),n=_t(e,n,o,r)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===i){if(s)return n;n=_t(e,n,o)}else{if("function"===i)return k((()=>{let r=t();for(;"function"==typeof r;)r=r();n=gt(e,r,n,o)})),()=>n;if(Array.isArray(t)){const i=[],a=n&&Array.isArray(n);if(pt(i,t,n,r))return k((()=>n=gt(e,i,n,o,!0))),()=>n;if(s){if(!i.length)return n;if(void 0===o)return n=[...e.childNodes];let t=i[0];if(t.parentNode!==e)return n;const r=[t];for(;(t=t.nextSibling)!==o;)r.push(t);return n=r}if(0===i.length){if(n=_t(e,n,o),c)return n}else a?0===n.length?ft(e,i,o):function(e,t,n){let o=n.length,r=t.length,s=o,i=0,c=0,a=t[r-1].nextSibling,l=null;for(;i<r||c<s;)if(t[i]!==n[c]){for(;t[r-1]===n[s-1];)r--,s--;if(r===i){const t=s<o?c?n[c-1].nextSibling:n[s-c]:a;for(;c<s;)e.insertBefore(n[c++],t)}else if(s===c)for(;i<r;)l&&l.has(t[i])||t[i].remove(),i++;else if(t[i]===n[s-1]&&n[c]===t[r-1]){const o=t[--r].nextSibling;e.insertBefore(n[c++],t[i++].nextSibling),e.insertBefore(n[--s],o),t[r]=n[s]}else{if(!l){l=new Map;let e=c;for(;e<s;)l.set(n[e],e++)}const o=l.get(t[i]);if(null!=o)if(c<o&&o<s){let a,u=i,h=1;for(;++u<r&&u<s&&null!=(a=l.get(t[u]))&&a===o+h;)h++;if(h>o-c){const r=t[i];for(;c<o;)e.insertBefore(n[c++],r)}else e.replaceChild(n[c++],t[i++])}else i++;else t[i++].remove()}}else i++,c++}(e,n,i):(n&&_t(e),ft(e,i));n=i}else if(t.nodeType){if(s&&t.parentNode)return n=c?[t]:t;if(Array.isArray(n)){if(c)return n=_t(e,n,o,t);_t(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}}return n}function pt(e,t,n,o){let r=!1;for(let s=0,i=t.length;s<i;s++){let i,c=t[s],a=n&&n[e.length];if(null==c||!0===c||!1===c);else if("object"==(i=typeof c)&&c.nodeType)e.push(c);else if(Array.isArray(c))r=pt(e,c,a)||r;else if("function"===i)if(o){for(;"function"==typeof c;)c=c();r=pt(e,Array.isArray(c)?c:[c],Array.isArray(a)?a:[a])||r}else e.push(c),r=!0;else{const t=String(c);a&&3===a.nodeType&&a.data===t?e.push(a):e.push(document.createTextNode(t))}}return r}function ft(e,t,n=null){for(let o=0,r=t.length;o<r;o++)e.insertBefore(t[o],n)}function _t(e,t,n,o){if(void 0===n)return e.textContent="";const r=o||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const i=t[s];if(r!==i){const t=i.parentNode===e;o||s?t&&i.remove():t?e.replaceChild(r,i):e.insertBefore(r,n)}else o=!0}}else e.insertBefore(r,n);return[r]}Symbol();var mt=ct("<li class=neon-user-message><span></span><span></span><span></span><span> </span><span>");const vt=e=>{return t=mt(),n=t.firstChild,o=n.nextSibling,r=o.nextSibling,s=r.nextSibling.nextSibling,ut(n,(()=>e.usernamePrefix)),ut(o,(()=>e.username)),ut(r,(()=>e.usernameSuffix)),ut(s,(()=>e.message)),k((t=>{var i=e.usernameClass,c=e.usernameClass,a=e.usernameClass,l=e.messageClass;return i!==t.e&&lt(n,t.e=i),c!==t.t&&lt(o,t.t=c),a!==t.a&&lt(r,t.a=a),l!==t.o&&lt(s,t.o=l),t}),{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t,n,o,r,s},wt=Symbol("store-raw"),yt=Symbol("store-node"),bt=Symbol("store-has"),St=Symbol("store-self");function Ct(e){let t=e[i];if(!t&&(Object.defineProperty(e,i,{value:t=new Proxy(e,xt)}),!Array.isArray(e))){const n=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let r=0,s=n.length;r<s;r++){const s=n[r];o[s].get&&Object.defineProperty(e,s,{enumerable:o[s].enumerable,get:o[s].get.bind(t)})}}return t}function kt(e){let t;return null!=e&&"object"==typeof e&&(e[i]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Et(e,t=new Set){let n,o,r,s;if(n=null!=e&&e[wt])return n;if(!kt(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,s=e.length;n<s;n++)r=e[n],(o=Et(r,t))!==r&&(e[n]=o)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const n=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let c=0,a=n.length;c<a;c++)s=n[c],i[s].get||(r=e[s],(o=Et(r,t))!==r&&(e[s]=o))}return e}function It(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Tt(e,t,n){if(e[t])return e[t];const[o,r]=C(n,{equals:!1,internal:!0});return o.$=r,e[t]=o}function Rt(e){P()&&Tt(It(e,yt),St)()}function Pt(e){return Rt(e),Reflect.ownKeys(e)}const xt={get(e,t,n){if(t===wt)return e;if(t===i)return n;if(t===c)return Rt(e),n;const o=It(e,yt),r=o[t];let s=r?r():e[t];if(t===yt||t===bt||"__proto__"===t)return s;if(!r){const n=Object.getOwnPropertyDescriptor(e,t);!P()||"function"==typeof s&&!e.hasOwnProperty(t)||n&&n.get||(s=Tt(o,t,s)())}return kt(s)?Ct(s):s},has:(e,t)=>t===wt||t===i||t===c||t===yt||t===bt||"__proto__"===t||(P()&&Tt(It(e,bt),t)(),t in e),set:()=>!0,deleteProperty:()=>!0,ownKeys:Pt,getOwnPropertyDescriptor:function(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return n&&!n.get&&n.configurable&&t!==i&&t!==yt?(delete n.value,delete n.writable,n.get=()=>e[i][t],n):n}};function $t(e,t,n,o=!1){if(!o&&e[t]===n)return;const r=e[t],s=e.length;void 0===n?(delete e[t],e[bt]&&e[bt][t]&&void 0!==r&&e[bt][t].$()):(e[t]=n,e[bt]&&e[bt][t]&&void 0===r&&e[bt][t].$());let i,c=It(e,yt);if((i=Tt(c,t,r))&&i.$((()=>n)),Array.isArray(e)&&e.length!==s){for(let t=e.length;t<s;t++)(i=c[t])&&i.$();(i=Tt(c,"length",s))&&i.$(e.length)}(i=c[St])&&i.$()}function At(e,t){const n=Object.keys(t);for(let o=0;o<n.length;o+=1){const r=n[o];$t(e,r,t[r])}}function Dt(e,t,n=[]){let o,r=e;if(t.length>1){o=t.shift();const s=typeof o,i=Array.isArray(e);if(Array.isArray(o)){for(let r=0;r<o.length;r++)Dt(e,[o[r]].concat(t),n);return}if(i&&"function"===s){for(let r=0;r<e.length;r++)o(e[r],r)&&Dt(e,[r].concat(t),n);return}if(i&&"object"===s){const{from:r=0,to:s=e.length-1,by:i=1}=o;for(let o=r;o<=s;o+=i)Dt(e,[o].concat(t),n);return}if(t.length>1)return void Dt(e[o],t,[o].concat(n));r=e[o],n=[o].concat(n)}let s=t[0];"function"==typeof s&&(s=s(r,n),s===r)||void 0===o&&null==s||(s=Et(s),void 0===o||kt(r)&&kt(s)&&!Array.isArray(s)?At(r,s):$t(e,o,s))}function qt(...[e,t]){const n=Et(e||{}),o=Array.isArray(n);return[Ct(n),function(...e){I((()=>{o&&1===e.length?function(e,t){if("function"==typeof t&&(t=t(e)),t=Et(t),Array.isArray(t)){if(e===t)return;let n=0,o=t.length;for(;n<o;n++){const o=t[n];e[n]!==o&&$t(e,n,o)}$t(e,"length",o)}else At(e,t)}(n,e[0]):Dt(n,e)}))}]}Symbol("store-root");const Mt=new WeakMap,Ot={get(e,t){if(t===wt)return e;const n=e[t];let o;return kt(n)?Mt.get(n)||(Mt.set(n,o=new Proxy(n,Ot)),o):n},set:(e,t,n)=>($t(e,t,Et(n)),!0),deleteProperty:(e,t)=>($t(e,t,void 0,!0),!0)};function Ut(e){return t=>{if(kt(t)){let n;(n=Mt.get(t))||Mt.set(t,n=new Proxy(t,Ot)),e(n)}return t}}const Bt='<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 682.667 682.667"> <defs> <clippath id="a" clipPathUnits="userSpaceOnUse"> <path d="M0 512h512V0H0Z"/> </clippath> </defs> <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="20" d="M566.098 396.393 396.39309093 566.09790907"/> <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="20" clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 0 682.667)"> <path d="M403.36 193.493 99.853 497H15v-84.853L318.507 108.64m21.213 21.213L445.786 23.787c11.716-11.716 30.711-11.716 42.427 0 11.715 11.715 11.715 30.711 0 42.426L382.146 172.279m42.428-42.426-42.427-42.427m84.853 0L424.574 45M214.706 87.426 87.427 214.705M193.493 108.64 256 171.147"/> <path d="M340.853 256 497 412.147V497h-84.853L256 340.853M171.147 256l-62.507-62.507m21.213-21.213L23.787 66.214c-11.716-11.716-11.716-30.711 0-42.427 11.715-11.715 30.711-11.715 42.426 0l106.066 106.067m-42.426-42.428-42.427 42.427m0-84.853L45 87.426"/> </g> </svg>';const Lt='<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 682.667 682.667"> <defs> <clippath id="a" clipPathUnits="userSpaceOnUse"> <path d="M0 512h512V0H0Z"/> </clippath> </defs> <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="20" clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 0 682.667)"> <path d="M365.396 449.11c1.854 13.365 1.85 26.017 1.239 36.121-.651 10.769-12.326 17.159-21.757 11.921l-6.069-3.372a22.39 22.39 0 0 0-21.745 0l-14.228 7.903a22.387 22.387 0 0 1-21.746 0l-14.221-7.901a22.389 22.389 0 0 0-21.747 0l-14.222 7.9a22.39 22.39 0 0 1-21.748 0l-14.22-7.9a22.39 22.39 0 0 0-21.748 0l-6.06 3.367c-9.432 5.24-21.107-1.15-21.758-11.92-1.847-30.555 1.863-84.393 45.647-110.863m129.982.004c17.261 10.438 28.293 25.13 35.211 40.972M107.347 283.81c-38.9-57.973-45.639-138.868-44.162-198.149 1.082-43.455 36.534-78.162 80.02-78.162h225.658c43.646 0 79.198 34.951 80.029 78.573 1.634 85.743-14.204 216.34-118.928 257.699m-149.261-.027c-20.174-7.995-37.016-19.315-51.047-32.997M328 344.017H184c-8.284 0-15 6.716-15 15 0 8.284 6.716 15 15 15h144c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15Z"/> <path d="M317.59 122.216c2.304-18.11-16.728-31.631-33.055-23.001l-14.372 7.597a25.744 25.744 0 0 1-24.068 0l-14.373-7.597c-16.635-8.793-36.077 5.408-32.901 24.031l2.746 16.09a26.088 26.088 0 0 1-7.438 23.013l-11.628 11.395c-13.458 13.189-6.031 36.167 12.568 38.884l16.069 2.348c8.423 1.23 15.704 6.55 19.471 14.222l7.186 14.64c8.317 16.943 32.35 16.943 40.668 0l7.186-14.64c3.767-7.672 11.048-12.992 19.471-14.222l16.07-2.348c18.598-2.717 26.025-25.695 12.566-38.884l-11.627-11.395a25.966 25.966 0 0 1-4.371-5.662M196.433 344.996l13.204 27.163m22.106-27.163 13.204 27.163m22.106-27.163 13.204 27.163m22.106-27.163 13.204 27.163"/> </g> </svg>';const jt='<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 512 512"> <path fill="currentColor" d="M255.107 65.06c5.562 0 10.071-4.509 10.071-10.071V10.071C265.178 4.509 260.669 0 255.107 0s-10.071 4.509-10.071 10.071v44.918c.001 5.562 4.51 10.071 10.071 10.071zM501.28 345.985l-17.791-17.741c-6.329-6.321-14.764-9.803-23.752-9.803-5.747 0-11.264 1.43-16.153 4.109l-33.526-33.486 1.633-1.631c13.601-13.628 13.596-35.773-.001-49.355a34.57 34.57 0 0 0-17.531-9.48 35.171 35.171 0 0 0 1.389-9.798c0-9.355-3.634-18.127-10.212-24.678a34.575 34.575 0 0 0-17.531-9.48 35.166 35.166 0 0 0 1.389-9.798c0-9.356-3.634-18.127-10.223-24.688a34.735 34.735 0 0 0-17.516-9.455c3.436-11.847.5-25.176-8.82-34.512-7.758-7.725-18.285-11.045-28.43-9.969L237.77 83.645c-10.132-1.922-22.785-3.193-30.772 4.092-.504.46-1.018.989-1.524 1.578-12.384-4.514-26.828-1.826-36.745 8.08-6.579 6.571-10.203 15.339-10.203 24.689 0 3.368.477 6.657 1.386 9.799a34.52 34.52 0 0 0-17.5 9.459c-6.592 6.565-10.227 15.323-10.234 24.662a35.112 35.112 0 0 0 1.39 9.826 34.596 34.596 0 0 0-17.522 9.45c-6.592 6.585-10.222 15.358-10.222 24.703 0 7.158 2.137 13.977 6.097 19.737a34.71 34.71 0 0 0-13.415 8.347c-13.61 13.593-13.615 35.739.009 49.387l1.627 1.62-33.53 33.469c-12.461-5.867-27.814-3.669-38.097 6.601l-17.802 17.752C4.381 353.22.895 361.656.894 370.649c0 8.994 3.487 17.431 9.819 23.756l22.217 22.19c3.935 3.931 10.312 3.927 14.242-.008 3.931-3.935 3.927-10.312-.008-14.242l-22.217-22.19c-2.522-2.519-3.911-5.895-3.911-9.505 0-3.609 1.389-6.984 3.905-9.497L42.744 343.4c4.448-4.443 11.256-5.105 16.426-2.014a10.023 10.023 0 0 0 4.161 3.563l102.093 101.943a10.04 10.04 0 0 0 2.02 2.922 10.024 10.024 0 0 0 2.835 1.984 13.325 13.325 0 0 1 3.352 8.885c0 3.61-1.389 6.985-3.911 9.504l-17.785 17.764c-5.255 5.232-13.803 5.231-19.042.016l-22.217-22.219c-3.933-3.933-10.309-3.933-14.242 0s-3.933 10.309 0 14.242l22.233 22.235c6.544 6.517 15.138 9.774 23.736 9.774 8.6 0 17.204-3.262 23.756-9.785l17.796-17.775c6.332-6.325 9.819-14.761 9.819-23.756 0-6.419-1.785-12.549-5.104-17.835l37.736-37.69.121-.123c4.321-4.467 16.354-3.631 27.991-2.823 8.268.575 17.486 1.214 26.492.176l41.324 41.275c-2.677 4.881-4.106 10.391-4.106 16.129 0 8.985 3.487 17.416 9.819 23.741l17.797 17.775c6.328 6.321 14.763 9.803 23.751 9.803 8.987 0 17.422-3.481 23.751-9.803l107.941-107.81c6.332-6.324 9.819-14.76 9.819-23.754-.001-8.993-3.488-17.429-9.826-23.759zm-267.26-242.55 43.687 8.269-26.149 26.139c-4.045-1.944-9.589-5.57-15.671-11.388-8.325-7.964-14.28-17.159-14.822-22.894l-.001-.009-.001-.003a8.798 8.798 0 0 1-.044-.992c1.317-.32 4.815-.675 13.001.878zm-51.058 8.211c5.102-5.097 13.028-5.685 18.793-1.781 3.267 13.698 14.952 26.113 20.209 31.143 3.896 3.728 16.397 14.905 29.015 17.977a14.685 14.685 0 0 1 2.636 8.442c0 3.965-1.525 7.672-4.304 10.448-2.771 2.776-6.484 4.304-10.456 4.304-3.973 0-7.686-1.528-10.47-4.317l-.001-.001-.005-.005-45.418-45.336c-2.769-2.765-4.294-6.472-4.294-10.436.001-3.965 1.526-7.672 4.295-10.438zm-26.316 43.947c2.771-2.775 6.48-4.304 10.446-4.304 3.971 0 7.692 1.532 10.481 4.318l36.572 36.499c5.759 5.768 5.759 15.154.02 20.902-2.786 2.775-6.512 4.303-10.491 4.303s-7.705-1.528-10.479-4.291l-.001-.001-27.745-27.739c-.043-.043-.09-.083-.134-.127l-8.68-8.676c-2.785-2.782-4.318-6.496-4.315-10.458.004-3.949 1.532-7.644 4.326-10.426zm-26.366 43.938c2.773-2.769 6.49-4.294 10.468-4.294 3.945 0 7.63 1.503 10.391 4.224l27.83 27.817c2.775 2.764 4.304 6.467 4.304 10.427 0 3.959-1.529 7.662-4.315 10.437-2.772 2.768-6.485 4.293-10.456 4.293-3.977 0-7.702-1.529-10.478-4.293l-10.089-10.077-.007-.007-17.647-17.626c-2.782-2.779-4.314-6.491-4.314-10.451 0-3.959 1.532-7.672 4.313-10.45zm-17.54 52.786c2.785-2.782 6.507-4.314 10.48-4.314 3.972 0 7.693 1.531 10.477 4.311l10.103 10.091c2.776 2.764 4.304 6.467 4.304 10.427s-1.529 7.662-4.325 10.448c-2.771 2.775-6.484 4.304-10.456 4.304-3.973 0-7.686-1.528-10.477-4.324l-1.265-1.26c-.017-.017-.03-.035-.046-.051l-.058-.052-8.727-8.693c-5.759-5.771-5.764-15.14-.01-20.887zm205.234 114.458c-3.931-3.936-10.308-3.939-14.242-.009l-8.96 8.949c-8.514 8.514-23.941 7.442-38.86 6.407-16.201-1.126-32.954-2.288-43.795 8.842l-37.095 37.05-92.763-92.627 32.828-32.769c5.426 3.326 11.687 5.109 18.238 5.109 9.359 0 18.135-3.628 24.69-10.195 6.599-6.572 10.234-15.343 10.234-24.699 0-.087-.006-.173-.006-.26.087.001.174.006.261.006 9.346 0 18.115-3.617 24.679-10.173 6.599-6.572 10.234-15.344 10.234-24.699 0-.087-.006-.173-.006-.26.088 0 .176.006.265.006 9.343 0 18.117-3.613 24.725-10.194 6.86-6.871 10.253-15.917 10.188-24.944.09.001.18.006.27.006 9.359-.001 18.134-3.628 24.699-10.205 6.579-6.571 10.203-15.339 10.203-24.689 0-6.539-1.778-12.79-5.093-18.205l28.773-28.761a14.775 14.775 0 0 1 7.559-4.028c.3-.032.596-.08.889-.138 4.446-.613 9.115.759 12.515 4.145 5.759 5.769 5.759 15.155.021 20.903l-8.763 8.727c-.029.029-.06.055-.089.084L299.48 160.23c-3.936 3.93-3.94 10.307-.009 14.242 3.932 3.936 10.308 3.939 14.242.009l8.798-8.786.006-.006 1.33-1.325c5.775-5.722 15.131-5.71 20.9.051 2.776 2.764 4.305 6.467 4.305 10.427 0 3.959-1.529 7.662-4.327 10.448l-8.813 8.831-.003.004-10.092 10.051c-3.941 3.925-3.954 10.302-.029 14.242 3.925 3.941 10.301 3.953 14.242.029l10.138-10.097c2.771-2.776 6.484-4.304 10.456-4.304 3.973 0 7.687 1.528 10.478 4.324 2.776 2.765 4.304 6.468 4.304 10.428 0 3.959-1.528 7.662-4.32 10.442l-17.57 17.577c-3.932 3.934-3.931 10.31.002 14.242a10.038 10.038 0 0 0 7.12 2.948c2.578 0 5.156-.984 7.122-2.951l8.611-8.614c.049-.047.102-.088.151-.137 2.771-2.776 6.484-4.304 10.456-4.304 3.973 0 7.686 1.528 10.467 4.314 5.753 5.747 5.748 15.117 0 20.875l-8.755 8.745-.01.009-.009.01-13.896 13.879c-3.935 3.931-3.939 10.308-.009 14.243a10.042 10.042 0 0 0 7.126 2.954c2.575 0 5.151-.982 7.117-2.945l6.797-6.789 32.577 32.539-92.755 92.642-33.234-33.194a39.602 39.602 0 0 0 6.615-5.323l8.955-8.944c3.937-3.929 3.941-10.306.01-14.241zm169.078 12.472-107.941 107.81c-2.525 2.522-5.905 3.911-9.517 3.911s-6.992-1.389-9.518-3.912l-17.797-17.775c-2.522-2.518-3.911-5.888-3.911-9.489 0-3.6 1.389-6.97 3.911-9.489l107.941-107.81c2.526-2.523 5.905-3.912 9.518-3.912 3.612 0 6.992 1.389 9.524 3.918l17.791 17.741c2.522 2.519 3.911 5.893 3.911 9.503-.001 3.611-1.39 6.986-3.912 9.504zM121.378 56.57a10.039 10.039 0 0 0 7.114 2.942c2.58 0 5.161-.986 7.128-2.957 3.929-3.937 3.923-10.313-.014-14.242L98.908 5.688c-3.936-3.929-10.313-3.924-14.242.014-3.929 3.937-3.923 10.313.014 14.242zm260.344 2.942c2.575 0 5.151-.982 7.117-2.945l36.67-36.626c3.935-3.93 3.939-10.307.008-14.242-3.93-3.935-10.306-3.939-14.242-.008l-36.67 36.626c-3.935 3.93-3.939 10.307-.008 14.242a10.039 10.039 0 0 0 7.125 2.953z"/> <path fill="currentColor" d="M62.819 433.204c-3.899 3.966-3.845 10.343.122 14.242l.029.028a10.005 10.005 0 0 0 7.038 2.882c2.607 0 5.214-1.009 7.189-3.018 3.899-3.966 3.83-10.357-.136-14.256-3.965-3.899-10.341-3.844-14.242.122zm279.787-80.937c1.532 0 3.086-.349 4.545-1.084 4.966-2.505 6.961-8.561 4.457-13.527-2.505-4.966-8.562-6.962-13.527-4.457l-.056.028c-4.966 2.505-6.933 8.547-4.429 13.513 1.768 3.508 5.324 5.527 9.01 5.527z"/> </svg>';var Nt=function(e){return e.Common="common",e.Contrast="contrast",e.Accent="accent",e}(Nt||{});const Ht=Nt;var Wt=ct("<div class=neon-lobby-user-row><div class=neon-username></div><div class=neon-lobby-user-row-menu>"),Ft=ct("<button>");const zt=e=>{return t=Wt(),n=t.firstChild,o=n.nextSibling,ut(n,(()=>e.username)),ut(o,Z(Vt,{get type(){return rt.Duel},get key(){return e.key},get canReceive(){return e.canReceive},get onUserRequestButtonClick(){return e.onUserRequestButtonClick},get children(){return Z(Bt,{})}}),null),ut(o,Z(Vt,{get type(){return rt.Trade},get key(){return e.key},get canReceive(){return e.canReceive},get onUserRequestButtonClick(){return e.onUserRequestButtonClick},get children(){return Z(Lt,{})}}),null),ut(o,Z(Vt,{get type(){return rt.Friend},get key(){return e.key},get canReceive(){return e.canReceive},get onUserRequestButtonClick(){return e.onUserRequestButtonClick},get children(){return Z(jt,{})}}),null),t;var t,n,o},Vt=e=>{return(t=Ft()).$$click=()=>e.onUserRequestButtonClick(e.type,e.key),ut(t,(()=>e.children)),k((n=>{var o,r=`neon-theme-front-${o=e.canReceive[e.type],o?Ht.Accent:Ht.Common}`,s=!e.canReceive[e.type];return r!==n.e&&lt(t,n.e=r),s!==n.t&&(t.disabled=n.t=s),n}),{e:void 0,t:void 0}),t;var t};at(["click"]);const Kt='<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 682.667 682.667"> <defs> <clippath id="a" clipPathUnits="userSpaceOnUse"> <path d="M0 512h512V0H0Z"/> </clippath> </defs> <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="15" clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 0 682.667)"> <path d="m212.398 425.63 43.603-42.85 110.795 108.885c5.955 5.85 13.843 9.071 22.216 9.071 8.372 0 16.261-3.221 22.214-9.071l83.859-82.411c5.984-5.88 9.416-14.063 9.416-22.45 0-8.386-3.432-16.569-9.416-22.449L384.918 256.088l110.104-108.203c6.022-5.918 9.476-14.153 9.479-22.593.003-8.441-3.445-16.678-9.459-22.599l-83.634-82.322c-5.965-5.872-13.861-9.106-22.233-9.106h-.002c-8.36 0-16.25 3.227-22.213 9.088L256.001 129.397 145.043 20.353c-5.965-5.861-13.856-9.088-22.216-9.088-8.373 0-16.269 3.234-22.235 9.107l-83.631 82.319c-6.105 6.011-9.464 14.037-9.46 22.601.002 8.44 3.457 16.673 9.475 22.591l110.108 108.205L16.915 364.355C10.93 370.238 7.5 378.42 7.5 386.804c0 8.385 3.43 16.566 9.412 22.446l83.862 82.415c5.95 5.849 13.84 9.071 22.215 9.071 8.373 0 16.262-3.221 22.215-9.071l41.752-41.032"/> <path d="m416.437 189.62-64.883 63.762a3.794 3.794 0 0 0 0 5.412L477.342 382.41a6.157 6.157 0 0 1 0 8.788l-83.859 82.411c-2.459 2.417-6.483 2.417-8.942 0L258.66 349.9a3.796 3.796 0 0 0-5.319 0L127.459 473.609c-2.459 2.416-6.482 2.416-8.941 0l-83.859-82.411a6.157 6.157 0 0 1 0-8.788l125.787-123.616a3.796 3.796 0 0 0 0-5.412L34.723 129.829a6.38 6.38 0 0 1-.004-9.097l83.632-82.32a6.378 6.378 0 0 1 8.946-.004l126.044 123.868a3.796 3.796 0 0 0 5.319 0L384.703 38.408a6.38 6.38 0 0 1 8.947.004l83.632 82.32a6.38 6.38 0 0 1-.003 9.097l-35.247 34.638"/> </g> </svg>';var Xt=ct("<div class=neon-lobby-user-row><div class=neon-lobby-user-row-info><div class=neon-theme-front-common></div></div><div class=neon-username></div><div class=neon-lobby-user-row-menu>"),Jt=ct("<button class=neon-theme-front-accent>");const Qt=e=>{return t=Xt(),n=t.firstChild,o=n.firstChild,r=n.nextSibling,s=r.nextSibling,ut(o,(()=>(e=>{switch(e){case rt.Duel:return Z(Bt,{});case rt.Trade:return Z(Lt,{});case rt.Friend:return Z(jt,{})}})(e.type))),ut(r,(()=>e.username)),ut(s,Z(Gt,{get type(){return e.type},get key(){return e.key},get onUserResponseButtonClick(){return e.onDeclineButtonClick},get children(){return Z(Kt,{})}}),null),ut(s,Z(Gt,{get type(){return e.type},get key(){return e.key},get onUserResponseButtonClick(){return e.onAcceptButtonClick},get children(){return Z('<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 682.667 682.667"> <defs> <clippath id="a" clipPathUnits="userSpaceOnUse"> <path d="M0 512h512V0H0Z"/> </clippath> </defs> <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="15" clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 0 682.667)"> <path d="m66.043 195.106-49.56 48.705c-5.71 5.612-8.983 13.415-8.983 21.407 0 7.993 3.273 15.795 8.981 21.406L79.7 348.751c5.672 5.575 13.185 8.647 21.153 8.647 7.968 0 15.481-3.072 21.155-8.649l88.529-87.001 179.456 176.359c5.675 5.576 13.187 8.646 21.154 8.646 7.967 0 15.479-3.07 21.152-8.646l63.218-62.126c5.709-5.612 8.984-13.415 8.983-21.407 0-7.993-3.274-15.796-8.982-21.406L231.69 73.894c-5.676-5.577-13.187-8.646-21.153-8.646-7.965 0-15.476 3.069-21.15 8.643l-98.324 96.627"/> <path d="m306.081 320.07-92.173-90.582c-1.861-1.829-4.879-1.829-6.741 0L104.224 330.655c-1.862 1.829-4.88 1.829-6.741 0L34.267 268.53a4.627 4.627 0 0 1 0-6.625l172.9-169.916c1.862-1.829 4.88-1.829 6.741 0l263.826 259.272a4.626 4.626 0 0 1 0 6.624l-63.216 62.125c-1.862 1.83-4.879 1.83-6.742 0l-76.398-75.08"/> </g> </svg>',{})}}),null),t;var t,n,o,r,s},Gt=e=>{return(t=Jt()).$$click=()=>e.onUserResponseButtonClick(e.type,e.key),ut(t,(()=>e.children)),t;var t};at(["click"]);var Zt=ct("<div class=neon-lobby-user-row><div class=neon-lobby-user-row-info><div class=neon-theme-front-common></div></div><div class=neon-username></div><div class=neon-lobby-user-row-menu>"),Yt=ct("<button class=neon-theme-front-accent>");const en=e=>{return t=Zt(),n=t.firstChild,o=n.firstChild,r=n.nextSibling,s=r.nextSibling,ut(o,(()=>(e=>{switch(e){case rt.Duel:return Z(Bt,{});case rt.Trade:return Z(Lt,{});case rt.Friend:return Z(jt,{})}})(e.type))),ut(r,(()=>e.username)),ut(s,Z(tn,{get type(){return e.type},get key(){return e.key},get onUserRequestButtonClick(){return e.onCancelButtonClick},get children(){return Z(Kt,{})}})),t;var t,n,o,r,s},tn=e=>{return(t=Yt()).$$click=()=>e.onUserRequestButtonClick(e.type,e.key),ut(t,(()=>e.children)),t;var t};at(["click"]);const nn=e=>Z(Y,{get each(){return e.activeUsers},children:t=>Z(zt,{get key(){return t.key},get username(){return t.username},get canReceive(){return t.canReceive},get onUserRequestButtonClick(){return e.onUserRequestButtonClick}})}),on=e=>Z(Y,{get each(){return e.incomingUserRequests},children:t=>Z(Qt,{get createdAt(){return t.createdAt},get type(){return t.type},get key(){return t.user.key},get username(){return t.user.username},get onAcceptButtonClick(){return e.onAcceptButtonClick},get onDeclineButtonClick(){return e.onDeclineButtonClick}})}),rn=e=>Z(Y,{get each(){return e.outgoingUserRequests},children:t=>Z(en,{get createdAt(){return t.createdAt},get type(){return t.type},get key(){return t.user.key},get username(){return t.user.username},get onCancelButtonClick(){return e.onCancelButtonClick}})}),sn=JSON.parse(document.querySelector('meta[name="resource"]').getAttribute("content")),cn=document.querySelector('meta[name="user-key"]').getAttribute("content"),an=new class{users=new Map;usersSet=new Map;get(e){return this.users.get(e)}getOrSet(e,t,n={Duel:!0,Friend:!0,Trade:!0}){const o=this.users.get(e);if(void 0!==o)return o;const[r,s]=qt({key:e,username:t,canReceive:n});return this.users.set(e,r),this.usersSet.set(e,s),r}mutate(e,t){this.usersSet.get(e)(Ut(t))}},ln=(new class{configureLogging(e){if(_e.isRequired(e,"logging"),void 0!==e.log)this.logger=e;else if("string"==typeof e){const t=function(e){const t=Ge[e.toLowerCase()];if(void 0!==t)return t;throw new Error(`Unknown log level: ${e}`)}(e);this.logger=new Se(t)}else this.logger=new Se(e);return this}withUrl(e,t){return _e.isRequired(e,"url"),_e.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return _e.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new te(e):this.reconnectPolicy=e:this.reconnectPolicy=new te,this}withServerTimeout(e){return _e.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return _e.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return void 0===this.httpConnectionOptions&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=null==e?void 0:e.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Le(this.url,e);return Je.create(t,this.logger||fe.instance,this.protocol||new Qe,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}).withUrl("Lobby/Hub").build(),un=new class{constructor(e,t,n,o,r,s,i){const[c,a]=qt([]),[l,u]=qt([]),[h,d]=qt([]);this.activeUsers=c,this.setActiveUsers=a,this.incomingUserRequests=l,this.setIncomingUserRequests=u,this.outgoingUserRequests=h,this.setOutgoingUserRequests=d,it((()=>Z(nn,{activeUsers:c,onUserRequestButtonClick:o})),e),it((()=>Z(on,{incomingUserRequests:l,onAcceptButtonClick:r,onDeclineButtonClick:s})),t),it((()=>Z(rn,{outgoingUserRequests:h,onCancelButtonClick:i})),n),setInterval((()=>console.log(c.length)),3e3)}OnUserActivated(e){this.setActiveUsers(Ut((t=>t.push(e))))}OnUserDeactivated(e){const t=this.activeUsers.findIndex((t=>t.key===e));this.setActiveUsers(Ut((e=>e.splice(t,1))))}OnUserRequestReceived(e){this.setIncomingUserRequests(Ut((t=>t.push(e))))}OnUserRequestResponded(e,t){const n=this.incomingUserRequests.findIndex((n=>n.user.key===e&&n.type===t));this.setIncomingUserRequests(Ut((e=>e.splice(n,1))))}OnUserRequestSent(e){this.setOutgoingUserRequests(Ut((t=>t.push(e))))}OnUserRequestCanceled(e,t){const n=this.outgoingUserRequests.findIndex((n=>n.user.key===e&&n.type===t));this.setOutgoingUserRequests(Ut((e=>e.splice(n,1))))}}(document.getElementById("neon-lobby-active-users"),document.getElementById("neon-lobby-incoming-user-requests"),document.getElementById("neon-lobby-outgoing-user-requests"),((e,t)=>{ln.send(`Send${e}Request`,{responderKey:t}),an.mutate(t,(t=>t.canReceive[e]=!1))}),((e,t)=>{ln.send(`Accept${e}Request`,{requesterKey:t})}),((e,t)=>{ln.send(`Decline${e}Request`,{requesterKey:t})}),((e,t)=>{ln.send(`Cancel${e}Request`,{responderKey:t}),an.mutate(t,(t=>t.canReceive[e]=!1))}));ln.on("Initialize",(e=>{e.activeUsers.forEach((e=>{const t=an.getOrSet(e.key,e.username);un.OnUserActivated(t)})),e.friends.forEach((e=>{const t=an.getOrSet(e.key,e.username);an.mutate(t.key,(e=>e.canReceive[rt.Friend]=!1))})),e.incomingUserRequests.forEach((e=>{const t=an.getOrSet(e.requesterKey,e.requesterUsername);un.OnUserRequestReceived({createdAt:e.createdAt,type:ot(e.type),user:t})})),e.outgoingUserRequests.forEach((e=>{const t=an.getOrSet(e.responderKey,e.responderUsername);an.mutate(t.key,(t=>t.canReceive[ot(e.type)]=!1)),un.OnUserRequestSent({createdAt:e.createdAt,type:ot(e.type),user:t})}))}));const hn=()=>[...document.getElementsByClassName("neon-user-messages")];let dn=!1;ln.onclose((()=>{dn?dn=!1:hn().forEach((e=>it((()=>Z(vt,{usernameClass:"",usernamePrefix:"[",get username(){return sn.systemName},usernameSuffix:"]",messageClass:"neon-theme-front-warning",get message(){return sn.connectionLost}})),e)))})),ln.on("ConnectedFromAnotherSource",(()=>{dn=!0,hn().forEach((e=>it((()=>Z(vt,{usernameClass:"",usernamePrefix:"[",get username(){return sn.systemName},usernameSuffix:"]",messageClass:"neon-theme-front-warning",get message(){return sn.connectedFromAnotherSource}})),e)))})),ln.on("SendMessage",(e=>{let t;switch(e.userRole){case et.Guest:t="neon-theme-front-common";break;case et.Standard:t="neon-theme-front-contrast";break;case et.Admin:t="neon-theme-front-accent"}hn().forEach((n=>it((()=>Z(vt,{usernameClass:t,get usernamePrefix(){return Ze(e.usernamePrefix)},get username(){return e.username},get usernameSuffix(){return Ze(e.usernameSuffix)},get messageClass(){return e.isImportant?"neon-theme-front-accent":"neon-theme-front-common"},get message(){return Ze(e.message)}})),n)))})),ln.on("ExecutedCommand",(e=>{hn().forEach((t=>it((()=>Z(vt,{usernameClass:"neon-theme-front-contrast",get usernamePrefix(){return Ze(e.usernamePrefix)},get username(){return e.username},get usernameSuffix(){return Ze(e.usernameSuffix)},messageClass:"neon-theme-front-success",get message(){return Ze(e.message)}})),t)))})),ln.on("InvalidCommand",(e=>{hn().forEach((t=>it((()=>Z(vt,{usernameClass:"neon-theme-front-contrast",get usernamePrefix(){return Ze(e.usernamePrefix)},get username(){return e.username},get usernameSuffix(){return Ze(e.usernameSuffix)},messageClass:"neon-theme-front-danger",get message(){return Ze(e.message)}})),t)))})),ln.on("UserConnectionToggled",(e=>{if(e.key===cn)return;if(!e.isActive)return void un.OnUserDeactivated(e.key);const n=new t.default(e.key,e.username);un.OnUserActivated(n)})),ln.on("DuelRequestSent",(e=>{})),ln.on("TradeRequestSent",(e=>{})),ln.on("FriendRequestSent",(e=>{})),ln.start();const gn=document.getElementById("neon-user-form"),pn=document.getElementById("neon-user-input");document.addEventListener("keydown",(e=>{switch(e.key){case"Enter":if(e.ctrlKey||e.shiftKey||e.altKey)return void e.preventDefault();if(""!==pn.value)return;e.preventDefault(),document.activeElement===pn?pn.blur():pn.focus();break;case"/":if(""!==pn.value)return;e.preventDefault(),pn.focus(),pn.value="/",pn.dispatchEvent(new Event("input"));break;case"!":if(""!==pn.value)return;e.preventDefault(),pn.focus(),pn.value="!",pn.dispatchEvent(new Event("input"));break}})),pn.addEventListener("input",(()=>{switch(pn.value[0]){case"/":pn.classList.add("neon-theme-front-warning");break;case"!":pn.classList.add("neon-theme-front-accent");break;case void 0:pn.classList.remove("neon-theme-front-warning","neon-theme-front-accent")}})),gn.addEventListener("submit",(e=>{e.preventDefault(),ln.send("HandleInput",pn.value),gn.reset(),pn.classList.remove("neon-theme-front-warning","neon-theme-front-accent")}))})();